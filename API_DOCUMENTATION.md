# BestGoods API æ–‡æ¡£

## ğŸŒ åŸºç¡€ä¿¡æ¯

### æœåŠ¡å™¨åœ°å€
- **æœ¬åœ°å¼€å‘**: `http://localhost:3000`
- **ç”Ÿäº§ç¯å¢ƒ**: `https://your-project.zeabur.app` (Zeaburæä¾›çš„åŸŸå)

### å“åº”æ ¼å¼
æ‰€æœ‰APIå“åº”éƒ½ä½¿ç”¨JSONæ ¼å¼ï¼š
```json
{
  "success": true,
  "data": {...},
  "message": "æ“ä½œæˆåŠŸ"
}
```

### é”™è¯¯å“åº”
```json
{
  "success": false,
  "message": "é”™è¯¯æè¿°",
  "code": "é”™è¯¯ä»£ç ï¼ˆå¯é€‰ï¼‰"
}
```

### HTTPçŠ¶æ€ç 
- `200` - æˆåŠŸ
- `400` - è¯·æ±‚å‚æ•°é”™è¯¯
- `404` - èµ„æºä¸å­˜åœ¨
- `429` - è¯·æ±‚è¿‡äºé¢‘ç¹
- `500` - æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

## ğŸ“Š å…¬å…±API

### 1. å¥åº·æ£€æŸ¥
æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€å’Œæ•°æ®åº“è¿æ¥ã€‚

**ç«¯ç‚¹**: `GET /health`

**å“åº”ç¤ºä¾‹**:
```json
{
  "status": "healthy",
  "timestamp": "2026-02-21T03:07:00.000Z",
  "port": 3000,
  "memory": {
    "totalVotes": 0,
    "totalComments": 0,
    "maxComments": 1000
  },
  "data": {
    "loaded": true,
    "categories": 195651,
    "products": 4580,
    "brands": 14
  }
}
```

### 2. ç»Ÿè®¡ä¿¡æ¯
è·å–æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯å’Œå†…å­˜çŠ¶æ€ã€‚

**ç«¯ç‚¹**: `GET /api/stats`

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "stats": {
    "level1": 49,
    "level2": 3270,
    "level3": 195651,
    "products": 4580,
    "brands": 14,
    "lastUpdated": "2026-02-21T03:07:00.000Z"
  },
  "memory": {
    "totalVotes": 0,
    "totalComments": 0,
    "maxComments": 1000
  }
}
```

## ğŸ—³ï¸ æŠ•ç¥¨ç³»ç»ŸAPI

### 1. æäº¤æŠ•ç¥¨
ä¸ºç”¨æˆ·å¯¹æŸä¸ªäº§å“è¿›è¡ŒæŠ•ç¥¨ã€‚

**ç«¯ç‚¹**: `POST /api/vote`

**è¯·æ±‚å¤´**:
```
Content-Type: application/json
```

**è¯·æ±‚ä½“**:
```json
{
  "productId": "product_1_1",
  "priceId": 1,
  "dimensionId": 1,
  "voteType": "like",
  "currentVote": null
}
```

**å‚æ•°è¯´æ˜**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | å–å€¼èŒƒå›´ |
|--------|------|------|------|----------|
| productId | string | æ˜¯ | äº§å“æ ‡è¯† | `product_<priceId>_<dimensionId>` |
| priceId | number | æ˜¯ | ä»·æ ¼åŒºé—´ID | 1-3 (1:ç»æµå‹, 2:æ ‡å‡†å‹, 3:é«˜ç«¯å‹) |
| dimensionId | number | æ˜¯ | è¯„æµ‹ç»´åº¦ID | 1-3 (1:æ€§ä»·æ¯”æœ€é«˜, 2:æœ€è€ç”¨, 3:æœ€èˆ’é€‚) |
| voteType | string | æ˜¯ | æŠ•ç¥¨ç±»å‹ | `like` æˆ– `dislike` |
| currentVote | string | å¦ | å½“å‰æŠ•ç¥¨çŠ¶æ€ | `null`, `like`, `dislike` |

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "likes": 5,
  "dislikes": 2
}
```

**é”™è¯¯å“åº”**:
```json
{
  "success": false,
  "message": "æ— æ•ˆçš„ priceIdï¼Œå¿…é¡»æ˜¯ 1-3 ä¹‹é—´çš„æ•°å­—"
}
```

### 2. æŠ•ç¥¨é€»è¾‘è¯´æ˜
- **é¦–æ¬¡æŠ•ç¥¨**: å¢åŠ å¯¹åº”ç±»å‹çš„è®¡æ•°
- **æ›´æ”¹æŠ•ç¥¨**: å‡å°‘åŸç±»å‹è®¡æ•°ï¼Œå¢åŠ æ–°ç±»å‹è®¡æ•°
- **å–æ¶ˆæŠ•ç¥¨**: å‡å°‘å¯¹åº”ç±»å‹è®¡æ•°
- **è®¡æ•°ä¿æŠ¤**: è®¡æ•°ä¸ä¼šä½äº0

## ğŸ’¬ è¯„è®ºç³»ç»ŸAPI

### 1. æäº¤è¯„è®º
ä¸ºç”¨æˆ·æ·»åŠ è¯„è®ºã€‚

**ç«¯ç‚¹**: `POST /api/comment`

**è¯·æ±‚å¤´**:
```
Content-Type: application/json
```

**è¯·æ±‚ä½“**:
```json
{
  "level1": "ä¸ªæŠ¤å¥åº·",
  "level2": "å‰ƒé¡»ç”¨å“",
  "level3": "ä¸€æ¬¡æ€§å‰ƒé¡»åˆ€",
  "content": "è¿™ä¸ªäº§å“å¾ˆå¥½ç”¨ï¼Œæ€§ä»·æ¯”é«˜",
  "user": "åŒ¿åç”¨æˆ·"
}
```

**å‚æ•°è¯´æ˜**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | é™åˆ¶ |
|--------|------|------|------|------|
| level1 | string | æ˜¯ | ä¸€çº§åˆ†ç±»åç§° | å¿…é¡»å­˜åœ¨ |
| level2 | string | æ˜¯ | äºŒçº§åˆ†ç±»åç§° | å¿…é¡»å­˜åœ¨ |
| level3 | string | æ˜¯ | ä¸‰çº§åˆ†ç±»åç§° | å¿…é¡»å­˜åœ¨ |
| content | string | æ˜¯ | è¯„è®ºå†…å®¹ | 1-500å­—ç¬¦ï¼Œä¸èƒ½ä¸ºç©º |
| user | string | å¦ | ç”¨æˆ·å | æœ€å¤š50å­—ç¬¦ï¼Œé»˜è®¤"åŒ¿åç”¨æˆ·" |

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "comment": {
    "user": "åŒ¿åç”¨æˆ·",
    "content": "è¿™ä¸ªäº§å“å¾ˆå¥½ç”¨ï¼Œæ€§ä»·æ¯”é«˜",
    "time": "2026-02-21 11:07:00",
    "level1": "ä¸ªæŠ¤å¥åº·",
    "level2": "å‰ƒé¡»ç”¨å“",
    "level3": "ä¸€æ¬¡æ€§å‰ƒé¡»åˆ€"
  },
  "totalComments": 1
}
```

**é”™è¯¯å“åº”**:
```json
{
  "success": false,
  "message": "è¯„è®ºå†…å®¹ä¸èƒ½è¶…è¿‡500ä¸ªå­—ç¬¦"
}
```

### 2. è·å–è¯„è®ºåˆ—è¡¨
è·å–æœ€æ–°çš„è¯„è®ºã€‚

**ç«¯ç‚¹**: `GET /api/comments`

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|------|------|--------|
| limit | number | å¦ | è¿”å›è¯„è®ºæ•°é‡ | 50 |

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "comments": [
    {
      "user": "åŒ¿åç”¨æˆ·",
      "content": "è¿™ä¸ªäº§å“å¾ˆå¥½ç”¨ï¼Œæ€§ä»·æ¯”é«˜",
      "time": "2026-02-21 11:07:00",
      "level1": "ä¸ªæŠ¤å¥åº·",
      "level2": "å‰ƒé¡»ç”¨å“",
      "level3": "ä¸€æ¬¡æ€§å‰ƒé¡»åˆ€"
    }
  ],
  "total": 1
}
```

## ğŸ” æœç´¢å’Œåˆ†ç±»API

### 1. é¦–é¡µæœç´¢
æœç´¢å“ç±»ã€‚

**ç«¯ç‚¹**: `GET /`

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| search | string | å¦ | æœç´¢å…³é”®è¯ |
| level1 | string | å¦ | ä¸€çº§åˆ†ç±»ç­›é€‰ |
| level2 | string | å¦ | äºŒçº§åˆ†ç±»ç­›é€‰ |

**å“åº”**: HTMLé¡µé¢

### 2. è¯¦æƒ…é¡µ
è·å–äº§å“è¯¦æƒ…é¡µã€‚

**ç«¯ç‚¹**: `GET /category/:level1/:level2/:level3`

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| level1 | string | æ˜¯ | ä¸€çº§åˆ†ç±»åç§°ï¼ˆURLç¼–ç ï¼‰ |
| level2 | string | æ˜¯ | äºŒçº§åˆ†ç±»åç§°ï¼ˆURLç¼–ç ï¼‰ |
| level3 | string | æ˜¯ | ä¸‰çº§åˆ†ç±»åç§°ï¼ˆURLç¼–ç ï¼‰ |

**ç¤ºä¾‹**:
```
GET /category/%E4%B8%AA%E6%8A%A4%E5%81%A5%E5%BA%B7/%E5%89%83%E9%A1%BB%E7%94%A8%E5%93%81/%E4%B8%80%E6%AC%A1%E6%80%A7%E5%89%83%E9%A1%BB%E5%88%80
```

**å“åº”**: HTMLé¡µé¢

## âš™ï¸ ç³»ç»Ÿé…ç½®

### CORSé…ç½®
- **å…è®¸æ¥æº**: æ‰€æœ‰åŸŸå (`*`)
- **å…è®¸æ–¹æ³•**: GET, POST, PUT, DELETE, OPTIONS
- **å…è®¸å¤´**: Content-Type, Authorization

### å®‰å…¨å¤´é…ç½®
- `X-Content-Type-Options: nosniff` - é˜²æ­¢MIMEç±»å‹å—…æ¢
- `X-Frame-Options: DENY` - é˜²æ­¢ç‚¹å‡»åŠ«æŒ
- `X-XSS-Protection: 1; mode=block` - é˜²æ­¢XSSæ”»å‡»
- `Strict-Transport-Security: max-age=31536000; includeSubDomains` - å¼ºåˆ¶HTTPS

### é€Ÿç‡é™åˆ¶
- **æœ€å¤§è¯·æ±‚æ•°**: 100æ¬¡/åˆ†é’Ÿ
- **æ—¶é—´çª—å£**: 60ç§’
- **è¶…å‡ºé™åˆ¶**: è¿”å›429çŠ¶æ€ç 

## ğŸ§ª APIæµ‹è¯•ç¤ºä¾‹

### ä½¿ç”¨curlæµ‹è¯•

#### æµ‹è¯•å¥åº·æ£€æŸ¥
```bash
curl -X GET "http://localhost:3000/health"
```

#### æµ‹è¯•æŠ•ç¥¨
```bash
curl -X POST "http://localhost:3000/api/vote" \
  -H "Content-Type: application/json" \
  -d '{
    "productId": "product_1_1",
    "priceId": 1,
    "dimensionId": 1,
    "voteType": "like"
  }'
```

#### æµ‹è¯•è¯„è®º
```bash
curl -X POST "http://localhost:3000/api/comment" \
  -H "Content-Type: application/json" \
  -d '{
    "level1": "ä¸ªæŠ¤å¥åº·",
    "level2": "å‰ƒé¡»ç”¨å“",
    "level3": "ä¸€æ¬¡æ€§å‰ƒé¡»åˆ€",
    "content": "æµ‹è¯•è¯„è®º",
    "user": "æµ‹è¯•ç”¨æˆ·"
  }'
```

#### æµ‹è¯•è·å–è¯„è®º
```bash
curl -X GET "http://localhost:3000/api/comments?limit=10"
```

### ä½¿ç”¨JavaScriptæµ‹è¯•

#### æŠ•ç¥¨ç¤ºä¾‹
```javascript
async function vote(productId, priceId, dimensionId, voteType) {
  try {
    const response = await fetch('/api/vote', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        productId,
        priceId,
        dimensionId,
        voteType,
        currentVote: userVotes[productId]
      })
    });
    
    const result = await response.json();
    if (result.success) {
      console.log('æŠ•ç¥¨æˆåŠŸ:', result);
      return result;
    } else {
      console.error('æŠ•ç¥¨å¤±è´¥:', result.message);
      return null;
    }
  } catch (error) {
    console.error('è¯·æ±‚å¤±è´¥:', error);
    return null;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
vote('product_1_1', 1, 1, 'like');
```

#### è¯„è®ºç¤ºä¾‹
```javascript
async function submitComment(level1, level2, level3, content, user = 'åŒ¿åç”¨æˆ·') {
  try {
    const response = await fetch('/api/comment', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ level1, level2, level3, content, user })
    });
    
    const result = await response.json();
    if (result.success) {
      console.log('è¯„è®ºæˆåŠŸ:', result);
      return result;
    } else {
      console.error('è¯„è®ºå¤±è´¥:', result.message);
      return null;
    }
  } catch (error) {
    console.error('è¯·æ±‚å¤±è´¥:', error);
    return null;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
submitComment('ä¸ªæŠ¤å¥åº·', 'å‰ƒé¡»ç”¨å“', 'ä¸€æ¬¡æ€§å‰ƒé¡»åˆ€', 'è¿™ä¸ªäº§å“å¾ˆå¥½ç”¨');
```

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

### è¾“å…¥éªŒè¯
æ‰€æœ‰APIç«¯ç‚¹éƒ½æœ‰å®Œæ•´çš„è¾“å…¥éªŒè¯ï¼š
1. **å¿…å¡«å­—æ®µæ£€æŸ¥** - ç¡®ä¿æ‰€æœ‰å¿…å¡«å­—æ®µéƒ½å­˜åœ¨
2. **æ•°æ®ç±»å‹æ£€æŸ¥** - éªŒè¯å‚æ•°ç±»å‹æ˜¯å¦æ­£ç¡®
3. **å–å€¼èŒƒå›´æ£€æŸ¥** - éªŒè¯å‚æ•°æ˜¯å¦åœ¨å…è®¸èŒƒå›´å†…
4. **é•¿åº¦é™åˆ¶æ£€æŸ¥** - é˜²æ­¢è¿‡é•¿çš„è¾“å…¥

### é”™è¯¯å¤„ç†
1. **å‹å¥½é”™è¯¯ä¿¡æ¯** - è¿”å›ç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯
2. **è¯¦ç»†æ—¥å¿—è®°å½•** - æœåŠ¡å™¨ç«¯è®°å½•è¯¦ç»†é”™è¯¯æ—¥å¿—
3. **é€‚å½“çŠ¶æ€ç ** - è¿”å›æ­£ç¡®çš„HTTPçŠ¶æ€ç 

### æ€§èƒ½è€ƒè™‘
1. **å†…å­˜é™åˆ¶** - è¯„è®ºæ•°é‡é™åˆ¶ä¸º1000æ¡
2. **æ•°æ®åº“ä¼˜åŒ–** - ä½¿ç”¨ç´¢å¼•å’Œé™åˆ¶æŸ¥è¯¢
3. **ç¼“å­˜è€ƒè™‘** - çƒ­ç‚¹æ•°æ®å¯è€ƒè™‘ç¼“å­˜

## ğŸ“ˆ ç›‘æ§å’Œæ—¥å¿—

### ç›‘æ§æŒ‡æ ‡
1. **APIå“åº”æ—¶é—´** - æ¯ä¸ªç«¯ç‚¹çš„å¹³å‡å“åº”æ—¶é—´
2. **é”™è¯¯ç‡** - APIé”™è¯¯å“åº”æ¯”ä¾‹
3. **å†…å­˜ä½¿ç”¨** - æœåŠ¡å™¨å†…å­˜ä½¿ç”¨æƒ…å†µ
4. **è¯·æ±‚é¢‘ç‡** - å„APIçš„è°ƒç”¨é¢‘ç‡

### æ—¥å¿—ä¿¡æ¯
æ¯ä¸ªè¯·æ±‚éƒ½ä¼šè®°å½•ï¼š
- æ—¶é—´æˆ³
- HTTPæ–¹æ³•
- è¯·æ±‚è·¯å¾„
- çŠ¶æ€ç 
- å“åº”æ—¶é—´

### å¥åº·æ£€æŸ¥
å®šæœŸæ£€æŸ¥ï¼š
- æ•°æ®åº“è¿æ¥çŠ¶æ€
- å†…å­˜ä½¿ç”¨æƒ…å†µ
- æœåŠ¡å™¨è¿è¡Œæ—¶é—´
- åŠŸèƒ½å¯ç”¨æ€§

## ğŸ”„ ç‰ˆæœ¬ç®¡ç†

### å½“å‰ç‰ˆæœ¬
- **APIç‰ˆæœ¬**: v1.0
- **æ•°æ®åº“ç‰ˆæœ¬**: 2026-02-20
- **ä»£ç ç‰ˆæœ¬**: 2026-02-21 03:07

### å‘åå…¼å®¹æ€§
æ‰€æœ‰APIéƒ½ä¿æŒå‘åå…¼å®¹ï¼š
1. **ä¸åˆ é™¤å­—æ®µ** - åªæ·»åŠ æ–°å­—æ®µ
2. **ä¸æ”¹å˜è¡Œä¸º** - ç°æœ‰åŠŸèƒ½è¡Œä¸ºä¸å˜
3. **æä¾›é»˜è®¤å€¼** - æ–°å­—æ®µæä¾›é»˜è®¤å€¼

### ç‰ˆæœ¬æ›´æ–°
å¦‚éœ€æ›´æ–°APIç‰ˆæœ¬ï¼š
1. åˆ›å»ºæ–°ç‰ˆæœ¬ç«¯ç‚¹ï¼ˆå¦‚`/api/v2/...`ï¼‰
2. ä¿æŒæ—§ç‰ˆæœ¬å…¼å®¹
3. é€æ­¥è¿ç§»ç”¨æˆ·
4. æœ€ç»ˆåºŸå¼ƒæ—§ç‰ˆæœ¬

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### å¸¸è§é—®é¢˜
1. **APIè¿”å›404**
   - æ£€æŸ¥ç«¯ç‚¹è·¯å¾„æ˜¯å¦æ­£ç¡®
   - æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
   - æ£€æŸ¥ç«¯å£é…ç½®

2. **APIè¿”å›400**
   - æ£€æŸ¥è¯·æ±‚å‚æ•°
   - æ£€æŸ¥å‚æ•°ç±»å‹
   - æ£€æŸ¥å‚æ•°å–å€¼èŒƒå›´

3. **APIè¿”å›429**
   - é™ä½è¯·æ±‚é¢‘ç‡
   - æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸è¯·æ±‚
   - è”ç³»ç®¡ç†å‘˜è°ƒæ•´é™åˆ¶

4. **APIè¿”å›500**
   - æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
   - æ£€æŸ¥æ•°æ®åº“è¿æ¥
   - æ£€æŸ¥å†…å­˜ä½¿ç”¨

### è·å–å¸®åŠ©
1. **æŸ¥çœ‹æœ¬æ–‡æ¡£** - äº†è§£APIä½¿ç”¨æ–¹æ³•
2. **æ£€æŸ¥æ—¥å¿—** - æŸ¥çœ‹è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
3. **æµ‹è¯•ç«¯ç‚¹** - ä½¿ç”¨curlæˆ–Postmanæµ‹è¯•
4. **è”ç³»å¼€å‘** - æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

---

**æ–‡æ¡£ç‰ˆæœ¬**: 2026-02-21 03:07  
**APIçŠ¶æ€**: âœ… æ‰€æœ‰APIæ­£å¸¸å·¥ä½œ  
**å®‰å…¨çŠ¶æ€**: âœ… æ‰€æœ‰å®‰å…¨é…ç½®å·²åº”ç”¨  
**æ€§èƒ½çŠ¶æ€**: âœ… ç»è¿‡å‹åŠ›æµ‹è¯•ï¼Œæ€§èƒ½ç¨³å®š